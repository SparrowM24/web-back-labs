{% extends "base.html" %}

{% block lab %}–ú–æ–∏ —Å—Ç–∞—Ç—å–∏{% endblock %}

{% block main %}
<div style="margin-bottom: 20px; padding: 10px; background: #f5f5f5;">
    <a href="/">–ì–ª–∞–≤–Ω–∞—è</a> | 
    <a href="/lab8/">–õ–∞–± 8</a> | 
    {% if current_user.is_authenticated %}
        <a href="/lab8/articles/">–°—Ç–∞—Ç—å–∏</a> | 
        <a href="/lab8/create_article/">–°–æ–∑–¥–∞—Ç—å</a> | 
        –ü—Ä–∏–≤–µ—Ç, {{ current_user.login }}! | 
        <a href="/lab8/logout/">–í—ã–π—Ç–∏</a>
    {% else %}
        <a href="/lab8/register/">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a> | 
        <a href="/lab8/login/">–í—Ö–æ–¥</a>
    {% endif %}
</div>
<style>
    .lab8-article-card {
        border: 1px solid #ddd;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
    }
    
    .lab8-article-actions {
        margin-top: 10px;
        display: flex;
        gap: 10px;
    }
    
    .lab8-button {
        padding: 8px 15px;
        background: #4364ac;
        color: white;
        border: none;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
    }
    
    .lab8-button-danger {
        background: #dc3545;
    }
    
    .lab8-button-danger:hover {
        background: #c82333;
    }
    
    .lab8-article-meta {
        font-size: 14px;
        color: #666;
        margin-bottom: 10px;
    }
    
    .lab8-section-title {
        margin-top: 30px;
        padding-bottom: 10px;
        border-bottom: 2px solid #4364ac;
    }
</style>

<h1>–ú–æ–∏ —Å—Ç–∞—Ç—å–∏</h1>

{% if current_user.is_authenticated %}
<a href="/lab8/create_article/" class="lab8-button">+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç–∞—Ç—å—é</a>

<h2 class="lab8-section-title">–ú–æ–∏ —Å—Ç–∞—Ç—å–∏</h2>
{% for article in user_articles %}
<div class="lab8-article-card">
    <h3>{{ article.title }}</h3>
    <div class="lab8-article-meta">
        {% if article.is_public %}üì¢ –ü—É–±–ª–∏—á–Ω–∞—è{% else %}üîí –ü—Ä–∏–≤–∞—Ç–Ω–∞—è{% endif %} | 
        –õ–∞–π–∫–æ–≤: {{ article.likes }}
    </div>
    <p>{{ article.article_text[:200] }}{% if article.article_text|length > 200 %}...{% endif %}</p>
    <div class="lab8-article-actions">
        <a href="/lab8/edit_article/{{ article.id }}/" class="lab8-button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        <form method="post" action="/lab8/delete_article/{{ article.id }}/" style="display:inline;">
            <button type="submit" class="lab8-button lab8-button-danger" 
                    onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é?')">
                –£–¥–∞–ª–∏—Ç—å
            </button>
        </form>
    </div>
</div>
{% else %}
<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞—Ç–µ–π.</p>
{% endfor %}

<h2 class="lab8-section-title">–ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
{% for article in public_articles %}
<div class="lab8-article-card">
    <h3>{{ article.title }}</h3>
    <div class="lab8-article-meta">–õ–∞–π–∫–æ–≤: {{ article.likes }}</div>
    <p>{{ article.article_text[:200] }}{% if article.article_text|length > 200 %}...{% endif %}</p>
</div>
{% else %}
<p>–ü–æ–∫–∞ –Ω–µ—Ç –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
{% endfor %}

{% else %}
<div style="color: #ff0000; background: #ffe6e6; padding: 15px; border: 1px solid #ff0000;">
    –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a href="/lab8/login/">–≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>
</div>
{% endif %}
{% endblock %}